	Considerando nuestro $DNI$, lo separamos en 4 cifras decimales y, si alguna de las dos partes empieza por 0,
	la rotamos a izquierda hasta que no lo sea. En el caso de que esto no sea posible porque una de esas partes
	es 0000, se puede tomar un número de 4 cifras que no empiece por 0 a elección.
	
	Sean $p$ y $q$ los primeros primos mayores o iguales que los bloques anteriores, sea $n = pq$ y $e \geq 11$
	el menor primo no divisor de $\phi(n)$\footnote{Nótese que $\phi$ es la función totiente de Euler.} y sea
	$d \equiv e^{-1} \mod \phi(n)$.
	\begin{enumerate}
		\item Cifra el mensaje $m = \mathrm{0xCAFE}$.
		\item Descifra el criptograma anterior.
		\item Intenta factorizar $n$ mediante el método $P-1$ de Pollard llegando, como máximo\footnote{Spoiler:
		No voy a respetar este límite.}, a $b = 8$.
		\item Intenta factorizar $n$ a partir de $\phi(n)$.
		\item Intenta factorizar $n$ a partir de $d$
	\end{enumerate}
\section*{Solución}
	Lo primero que calculamos son los parámetros que utilizará RSA. En particular, para mi $DNI$ se tiene que:
	\begin{itemize}
		\item $(p,\ q) = (2609,\ 9199)$
		\item $n = 24000191, \quad \phi(n) = 23988384$
		\item $e = 11, \quad d \equiv e^{-1} \mod \phi(n) = 10903811$
	\end{itemize}
	
	\begin{enumerate}
		\item Para el cifrado RSA nos basta con calcular $c = m^e \mod n$, veámoslo en nuestro caso particular:
		$$\mathrm{0xCAFE}^{11} = \mathrm{0xCAFE}^{1011_2} = \left(\left(\left(\mathrm{0xCAFE}^2\right)^2\right)
		\cdot \mathrm{0xCAFE}\right)^2 \cdot \mathrm{0xCAFE} \equiv \mathrm{0xE3CD33} \mod n$$
		
		\item Para el descifrado RSA, utilizaremos $d$ en lugar de $e$, es decir, $m = c^d \mod n$: \\
		\begin{gather*}
			\mathrm{0xE3CD33}^{10903811} = \mathrm{0xE3CD33}^{1010\ 0110\ 0110\ 0001\ 0000\ 0011_2} = \\
			\left(\left( \cdots \left(\left(\left(\mathrm{0xE3CD33}^2\right)^2 \cdot \mathrm{0xE3CD33}
			\right)^2\right)^2 \cdots \right)^2 \cdot \mathrm{0xE3CD33}\right)^2 \cdot \mathrm{0xE3CD33}
			\equiv \mathrm{0xCAFE} \mod n
		\end{gather*}
		
		Adicionalmente, y para mejorar la eficiencia del cálculo podemos calcular $m = c^{d \mod \phi(p)} \mod p$
		y $m = c^{d \mod \phi(q)} \mod q$, y resolver el sistema de congruencias resultante:
		$$\left.\begin{aligned}
		        \mathrm{0xE3CD33}^{10903811 \mod \phi(2609)} &= \mathrm{0xE3CD33}^{2371} &\equiv \mathrm{0x95B} \mod 2609\\
		        \mathrm{0xE3CD33}^{10903811 \mod \phi(9199)} &= \mathrm{0xE3CD33}^{4181} &\equiv \mathrm{0x1753} \mod 9199
		       \end{aligned}
		\right\} = \mathrm{0xCAFE} = m$$
	\end{enumerate}
