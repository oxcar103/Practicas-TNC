	Sea $n$ el siguiente número primo\footnote{Aunque conocemos este hecho, dado que la utilidad de este ejercicio
	es conocer y poner a prueba nuestro conocimiento sobre tests de primalidad, lo ignoraremos y trataremos a $n$
	como un número que queremos ver si es primo.} mayor estricto que tu DNI, así $n$ tendrá 8 cifras decimales.
	\begin{enumerate}
		\item Con $P = 3$ y $Q = -1$, define un entero cuadrático $\alpha$ y sus sucesiones de Lucas.
		\item Para el discriminante correspondiente, $\Delta = P^2 - 4Q = 13$, calcula el símbolo de Jacobi
		$\displaystyle \left(\frac{\Delta}{n}\right)$ y define $\displaystyle r = n - \left(\frac{\Delta}{n}\right)$.
		Si tu $n$ fuera primo, ¿qué debería pasarle a $\alpha^r$? ¿Y a los términos $V_r$ y $U_r$?
		\item Calcula los términos $V_r$ y $U_r$ módulo $n$ de las sucesiones de Lucas con el algoritmo de izquierda
		a derecha.
		\item ¿Se verifica el Teorema Pequeño de Fermat (TPF) para $\alpha$? ¿Qué deduces sobre la primalidad de
		tu $n$?
	\end{enumerate}

\section*{Solución}
   \begin{enumerate}
        \item Claramente, definimos $\displaystyle \alpha = \frac{P + \sqrt{\Delta}}{2}$ con $\Delta = P^2 - 4Q$,
        y tenemos que $\Delta = 3^2 - 4(-1) = 9+4 = 13$ y $\displaystyle \alpha = \frac{3 + \sqrt{13}}{2}$
        
        Podemos comprobar que nuestro $\alpha$ es un entero algebraico pues $a = \alpha + \beta, b = \alpha
        \beta \in \mathbb{Z}$ con $\displaystyle \beta = \overline{\alpha} = \frac{P - \sqrt{\Delta}}{2}$:
        $$\displaystyle a = \frac{P + \sqrt{\Delta}}{2} + \frac{P - \sqrt{\Delta}}{2} = P = 3, \qquad
        b = \frac{P + \sqrt{\Delta}}{2} \cdot \frac{P - \sqrt{\Delta}}{2} = \frac{P^2-\Delta}{2^2} =
        \frac{P^2-(P^2-4Q)}{4} = Q = -1$$
        
        De aquí deducimos que su polinomio primitivo mínimo es $f(x) = x^2 -3x -1$. A partir de aquí, podemos
        deducir que $\alpha^2 -3\alpha -1 = 0 \Leftrightarrow \alpha^2  = 3\alpha +1 \Leftrightarrow \alpha^n  =
        3\alpha^{n-1} + \alpha^{n-2}$
        
        Ahora, como $\mathbb{Q\left(\alpha\right)} = \mathbb{Q\left(\sqrt{\Delta}\right)}$ con $\left\lbrace1,
        \sqrt{\Delta}\right\rbrace$ es una base de este cuerpo, podemos escribir $\displaystyle \alpha^n =
        \frac{V_n}{2} + \frac{U_n}{2}\sqrt{\Delta}$ con $U_i, V_i \in \mathbb{Z}$.
        
        Además, podemos usar la expresión $\alpha^n  = 3\alpha^{n-1} + \alpha^{n-2}$ encontrada antes para
        concluir que $\displaystyle \frac{V_n}{2} + \frac{U_n}{2}\sqrt{\Delta} = \alpha^n  = 3\alpha^{n-1} +
        \alpha^{n-2} = 3\left(\frac{V_{n-1}}{2} + \frac{U_{n-1}}{2}\sqrt{\Delta}\right) -\left(\frac{V_{n-2}}{2} +
        \frac{U_{n-2}}{2}\sqrt{\Delta}\right) = \frac{3V_{n-1}-V_{n-2}}{2} + \frac{3U_{n-1}-U_{n-2}}{2}\sqrt{\Delta}$

        De donde concluimos que:
        $$\left\lbrace
   			V_n = 3V_{n-1}-V_{n-2} \atop
   			U_n = 3U_{n-1}-U_{n-2}
   		\right.$$
   		
   		Cumplen por tanto una relación de recurrencia, ahora sólo tenemos que calcular algunos valores para tener
   		completamente determinada la recurrencia. En nuestro caso, es fácil ver que:
		$$\left.
   			\displaystyle 1 = \alpha^0 = \frac{V_0}{2} + \frac{U_0}{2}\sqrt{\Delta} \Rightarrow V_0 = 2, \quad U_0 = 0 \atop
   			\displaystyle \frac{P + \sqrt{\Delta}}{2} = \alpha^1 = \frac{V_1}{2} + \frac{U_1}{2}\sqrt{\Delta}\Rightarrow V_1 = P = 3, \quad U_1 = 1 
   		\right.$$
   		
   		A las sucesiones de estos valores $V_n$ y $U_n$ que siguen la recurrencia que acabamos de ver es lo que
   		llamaremos \textit{Sucesiones de Lucas}.
   		
		\item Para calcular el símbolo de Jacobi $\displaystyle \left(\frac{\Delta}{n}\right)$ haremos uso del
		algorimto de cálculo explicado algunos ejercicios más atrás, por lo que no veo necesaria la explicación
		del algoritmo o del proceso pues ya se detalló en su momento, que sería el siguiente:
		$$\left(\frac{\Delta}{n}\right) =\footnote{Recordemos que para este ejercicio, nuestro $n$ era
		distinto, en lugar de ser el DNI, es el siguiente primo, en mi caso, $n = 26050967$.} \left(\frac{13}
		{26050967} \right)= \left(\frac{26050967}{13}\right) = \left(\frac{7}{13}\right) = \left(\frac{13}{7}\right)
		= \left(\frac{6}{7}\right) = \left(\frac{2}{7}\right) \cdot \left(\frac{3}{7}\right) = 1 \cdot
		\left(\frac{3}{7}\right) = -\left(\frac{7}{3}\right) = -\left(\frac{1}{3}\right) = -1$$
		
		De aquí, deducimos inmediatamente que $\displaystyle r = n - \left(\frac{\Delta}{n}\right) = 26050968$
		
		Ahora, estudiaremos los valores teóricos de $\alpha^r$, $U_r$ y $V_r$ en el caso de que $n$ fuese primo.
		Si $n$ es primo, tenemos que $\displaystyle |m| < |n| \Rightarrow \gcd(m, n) = 1 \quad \forall m \in
		\mathbb{Q}$ y podemos aplicar un resultado que se deduce del Pequeño Teorema de Fermat(PTF)\footnote{Hay
		un resultado análogo para $V_r$ y $U_r$ que básicamente dice que $U_r \equiv_n 0$ y que $V_r \equiv_n
		2\alpha^r$.}. En particular, tenemos que $|2Q\Delta| < |n|$ por lo que se cumple dicho resultado:
		$$\alpha^r = \alpha^{n-\left(\frac{\Delta}{n}\right)} \equiv_n \left\lbrace
			1 \qquad \text{Si } \left(\frac{\Delta}{n}\right) = 1 \atop
			Q \qquad \text{Si } \left(\frac{\Delta}{n}\right) = -1
		\right.$$
		
		Por lo que para nuestro caso particular se tiene que $\alpha^r \equiv_n Q = -1$. Trivialmente se deduce
		que $U_r \equiv_n 0$ y $V_r \equiv_n 2Q = -2$
		
		\item Para este apartado, reutilizaremos el algoritmo de la primera práctica con pequeñas modificaciones
		pues, aunque sirve para calcular $\alpha^r$, no es tan fácil calcular $U_r$ y $V_r$ a partir de él.
		Principalmente, tenemos que modificar la salida para que nos devuelva por separado la componente racional
		de la irracional, tener en cuenta que $V_i$ y $U_i$ son el doble de las componentes racional e irracional
		respectivamente y redefinir el producto aprovechándonos de la siguiente propiedad:
		$$\left(a+b\sqrt{e}\right)\left(c+d\sqrt{e}\right)=\left(ac+bde\right)+\left(ad+cb\right)\sqrt{e}$$
		
		Finalmente, el algoritmo quedaría:
		
		Los resultados obtenidos son:
		\begin{center}
		  \begin{tabular}{ | r | c | c |}
		    \hline
		    i	& $V_i$	& $U_i$ \\
		    \hline
			1       & 3     & 1 \\
			3       & 36    & 10 \\
			6       & 1298  & 360 \\
			12      & 1684802       & 467280 \\
			24      & 18363915      & 14055820 \\
			49      & 11672958      & 4428956 \\
			99      & 20937720      & 23911249 \\
			198     & 23382471      & 21523686 \\
			397     & 15848977      & 22985641 \\
			795     & 25678459      & 18739467 \\
			1590    & 14759824      & 15744084 \\
			3180    & 20679959      & 20945882 \\
			6360    & 6271843       & 2028203 \\
			12720   & 18332426      & 13856864 \\
			25440   & 22940247      & 25097842 \\
			50880   & 25379149      & 18394763 \\
			101761  & 463429        & 21134127 \\
			203523  & 14461565      & 17713358 \\
			407046  & 11784831      & 20336956 \\
			814092  & 3753301       & 21713753 \\
			1628185 & 5185797       & 9148345 \\
			3256371 & 11511884      & 520085 \\
			6512742 & 15819230      & 20750332 \\
			13025484        & 0     & 2635672 \\
			26050968        & 26050965      & 0 \\
		    \hline
		  \end{tabular}
		\end{center}
		
    \end{enumerate}
