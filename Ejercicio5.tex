	Dado tu número $n$:
	\begin{enumerate}
		\item Sea $d$ el primer elemento de la sucesión $5, -7, 9, -11, 13,\dots$ que satisface que el símbolo
		de Jacobi $\displaystyle \left(\frac{d}{n}\right) = -1$.
		\item Con el discriminante $d$, define $r = n+1$\footnote{En esta práctica, definimos $r$ igual que en
		la práctica anterior $r = n - \displaystyle \left(\frac{d}{n}\right)$ con la diferencia de que, por la
		elección del discriminante $d$, se tiene que $\displaystyle \left(\frac{d}{n}\right) = -1$.}, $P = 1$,
		$Q = \displaystyle \frac{1-d}{4}$, el entero cuadrático $\alpha$ y las sucesiones de Lucas asociadas.
		\item Si tu $n$ fuera primo, ¿Qué debería pasarle a los términos $V_r$ y $U_r$? ¿Y a los términos
		$V_{\frac{r}{2}}$ y $U_{\frac{r}{2}}$?
		\item Calcula los términos $V_{\frac{r}{2}}$, $U_{\frac{r}{2}}$, $V_r$ y $U_r$ módulo $n$ de las sucesiones
		de Lucas con el último algoritmo iterativo.
		\item ¿Se verifica el Teorema Pequeño de Fermat (TPF) para $\alpha$? ¿Qué deduces sobre la primalidad
		de tu $n$?
	\end{enumerate}

\section*{Solución}
	\begin{enumerate}
		\item Para calcular el símbolo de Jacobi $\displaystyle \left(\frac{d}{n}\right)$\footnote{Recordemos que
		para este ejercicio, nuestro $n$ era distinto, en lugar de ser el DNI, es $n = 678650380744579$.} haremos
		uso del algorimto \ref{Jac-symbol} para cada uno de los valores hasta encontrar el que nos devuelva el
		valor deseado:
		$$\left(\frac{5}{n}\right) = \left(\frac{5}{678650380744579} \right)= \left(\frac{678650380744579}{5}\right)
		= \left(\frac{4}{5}\right) = \left(\frac{2^2}{5}\right) = \left(\frac{2}{5}\right)^2 = 1$$
		
		$$\displaystyle \left(\frac{-7}{n}\right) = \left(\frac{678650380744572}{678650380744579} \right)=
		-\left(\frac{339325190372286}{678650380744579} \right) = \left(\frac{169662595186143}{678650380744579} \right)
		= \atop \displaystyle -\left(\frac{678650380744579}{169662595186143} \right) = -\left(\frac{7}
		{169662595186143} \right) = \left(\frac{169662595186143}{7} \right) = \left(\frac{3}{7} \right) =
		-\left(\frac{7}{3} \right) = -\left(\frac{1}{3} \right) = -1$$
		
		\item Dado que $d = -7$, primero definimos $r = n+1 = 678650380744580$.
		
		Claramente, definimos $\displaystyle \alpha = \frac{P + \sqrt{\Delta}}{2}$ con $\Delta = P^2 - 4Q$,
		y tenemos que $\displaystyle \Delta = 1^2 - 4\left(\frac{1-d}{4}\right) = 1-8 = -7$ y $\displaystyle
		\alpha = \frac{1 + \sqrt{-7}}{2}$
		
		Podemos comprobar que nuestro $\alpha$ es un entero algebraico pues $a = \alpha + \beta, b = \alpha
		\beta \in \mathbb{Z}$ con $\displaystyle \beta = \overline{\alpha} = \frac{P - \sqrt{\Delta}}{2}$:
		$$\displaystyle a = \frac{P + \sqrt{\Delta}}{2} + \frac{P - \sqrt{\Delta}}{2} = P = 1, \qquad
		b = \frac{P + \sqrt{\Delta}}{2} \cdot \frac{P - \sqrt{\Delta}}{2} = \frac{P^2-\Delta}{2^2} =
		\frac{P^2-(P^2-4Q)}{4} = Q = \left(\frac{1-d}{4}\right) = 2$$
		
		De aquí deducimos que su polinomio primitivo mínimo es $f(x) = x^2 -x +2$. A partir de aquí, podemos
		deducir que $\alpha^2 -\alpha +2 = 0 \Leftrightarrow \alpha^2  = \alpha -2 \Leftrightarrow \alpha^n =
		\alpha^{n-1} - 2\alpha^{n-2}$
		
		Ahora, como $\mathbb{Q\left(\alpha\right)} = \mathbb{Q\left(\sqrt{\Delta}\right)}$ con $\left\lbrace1,
		\sqrt{\Delta}\right\rbrace$ es una base de este cuerpo, podemos escribir $\displaystyle \alpha^n =
		\frac{V_n}{2} + \frac{U_n}{2}\sqrt{\Delta}$ con $U_i, V_i \in \mathbb{Z}$.
		
		Además, podemos usar la expresión $\alpha^n  = \alpha^{n-1} - 2\alpha^{n-2}$ encontrada antes para
		concluir que $\displaystyle \frac{V_n}{2} + \frac{U_n}{2}\sqrt{\Delta} = \alpha^n  = \alpha^{n-1} -
		2\alpha^{n-2} = \left(\frac{V_{n-1}}{2} + \frac{U_{n-1}}{2}\sqrt{\Delta}\right) -2\left(\frac{V_{n-2}}{2} +
		\frac{U_{n-2}}{2}\sqrt{\Delta}\right) = \frac{V_{n-1}-2V_{n-2}}{2} + \frac{U_{n-1}-2U_{n-2}}{2}\sqrt{\Delta}$
		
		De donde concluimos que:
		$$\left\lbrace
			V_n = V_{n-1}-2V_{n-2} \atop
			U_n = U_{n-1}-2U_{n-2}
		\right.$$
		
		Cumplen por tanto una relación de recurrencia, ahora sólo tenemos que calcular algunos valores para tener
		completamente determinada la recurrencia. En nuestro caso, es fácil ver que:
		$$\left.
			\displaystyle 1 = \alpha^0 = \frac{V_0}{2} + \frac{U_0}{2}\sqrt{\Delta} \Rightarrow V_0 = 2, \quad U_0 = 0 \atop
			\displaystyle \frac{P + \sqrt{\Delta}}{2} = \alpha^1 = \frac{V_1}{2} + \frac{U_1}{2}\sqrt{\Delta}\Rightarrow V_1 = P = 1, \quad U_1 = 1 
		\right.$$
		
		A las sucesiones de estos valores $V_n$ y $U_n$ que siguen la recurrencia que acabamos de ver es lo que
		llamaremos \textit{Sucesiones de Lucas}.
		
		\item Si $n$ es primo, tenemos que $\displaystyle |m| < |n| \Rightarrow \gcd(m, n) = 1 \quad \forall m \in
		\mathbb{Q}$ y podemos aplicar un resultado que se deduce del Pequeño Teorema de Fermat(PTF)\footnote{Hay un
		resultado análogo para $V_r$ y $U_r$ que básicamente dice que $U_r \equiv_n 0$ y que $V_r \equiv_n 2\alpha^r$.}.
		En particular, tenemos que $|2Q\Delta| < |n|$ por lo que se cumple dicho resultado:
		$$\alpha^r = \alpha^{n-\left(\frac{\Delta}{n}\right)} \equiv_n \left\lbrace
			1 \qquad \text{Si } \left(\frac{\Delta}{n}\right) = 1 \atop
			Q \qquad \text{Si } \left(\frac{\Delta}{n}\right) = -1
		\right.$$
		
		Por lo que para nuestro caso particular se tiene que $\displaystyle \alpha^r \equiv_n Q = \left(\frac{1-d}
		{4}\right) = 2$. Trivialmente se deduce que $U_r \equiv_n 0$ y $V_r \equiv_n 2Q = 4$
	\end{enumerate}
